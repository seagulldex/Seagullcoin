l<!DOCTYPE html>
<html>
  <head>
    <title>SGLCN-X20 Explorer</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
        background-color: #000;
        color: #fff;
      }
      .block {
        border: 1px solid #444;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-radius: 6px;
        background-color: #111;
      }
      h1 {
        display: flex;
        align-items: center;
        font-size: 2rem;
      }
      h1 img {
        height: 40px;
        width: 40px;
        border-radius: 50%;
        margin-right: 10px;
      }
      a {
        color: #1e90ff;
      }
      .modal {
  background: #222;
  color: #eee;
  position: fixed;
  top: 10%;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 600px;
  border: 2px solid #1e90ff;
  padding: 1rem 2rem;
  z-index: 1000;
  border-radius: 8px;
  display: none;
  box-shadow: 0 0 10px #1e90ff;
}
.modal.active {
  display: block;
}
.modal button {
  background: #1e90ff;
  border: none;
  color: white;
  padding: 0.5rem 1rem;
  margin-top: 1rem;
  cursor: pointer;
  border-radius: 4px;
}
  #pagination button {
  background-color: #222;
  border: 1px solid #444;
  color: white;
  padding: 0.3rem 0.8rem;
  margin: 0 0.3rem;
  border-radius: 4px;
  cursor: pointer;
  font-size: 1rem;
  transition: background-color 0.3s;
}

#pagination button:hover:not(:disabled) {
  background-color: #555;
}

#pagination button:disabled {
  opacity: 0.4;
  cursor: default;
}
  .hash-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .hash-link {
    color: #1e90ff;
    text-decoration: none;
    font-family: monospace;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 250px; /* adjust as needed */
    display: inline-block;
    vertical-align: bottom;
  }

  .hash-link:hover {
    text-decoration: underline;
  }
    </style>
  </head>
  <body>
    <h1>
      <img src="https://pbs.twimg.com/profile_images/1874512448151314432/Axe_9hCH.jpg" alt="SeagullCoin Logo">
      SGLCN-X20 Block Explorer
    </h1>
    <input type="text" id="search" placeholder="Search by address or hash..." style="width: 100%; padding: 0.5rem; margin-bottom: 1rem;" />
    <div id="blocks">Loading...</div>

 <script>
  let allBlocks = [];
  let currentPage = 1;
  const blocksPerPage = 5;

  const container = document.getElementById('blocks');
  const searchInput = document.getElementById('search');

  // Highlight matched text helper
  function highlightMatch(text, query) {
    if (!query) return text;
    const regex = new RegExp(`(${query.replace(/[-/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
    return text.replace(regex, '<mark>$1</mark>');
  }

  // Render pagination controls
  function renderPagination(totalBlocks) {
    const paginationDivId = 'pagination';
    let paginationDiv = document.getElementById(paginationDivId);

    if (!paginationDiv) {
      paginationDiv = document.createElement('div');
      paginationDiv.id = paginationDivId;
      paginationDiv.style.marginTop = '1rem';
      paginationDiv.style.textAlign = 'center';
      container.after(paginationDiv);
    }

    const totalPages = Math.ceil(totalBlocks / blocksPerPage);

    if (totalPages <= 1) {
      paginationDiv.innerHTML = '';
      return;
    }

    paginationDiv.innerHTML = `
      <button id="prevPage" ${currentPage === 1 ? 'disabled' : ''}>⬅ Prev</button>
      <span style="margin: 0 1rem;">Page ${currentPage} of ${totalPages}</span>
      <button id="nextPage" ${currentPage === totalPages ? 'disabled' : ''}>Next ➡</button>
    `;

    document.getElementById('prevPage').onclick = () => {
      if (currentPage > 1) {
        currentPage--;
        renderBlocks(searchInput.value.trim());
      }
    };
    document.getElementById('nextPage').onclick = () => {
      if (currentPage < totalPages) {
        currentPage++;
        renderBlocks(searchInput.value.trim());
      }
    };
  }

  // Render blocks filtered and paginated
  function renderBlocks(query = '') {
    const filtered = allBlocks.filter(block => {
      query = query.toLowerCase();

      if (block.hash.toLowerCase().includes(query)) return true;
      if (block.previousHash.toLowerCase().includes(query)) return true;
      if (block.transactions.some(tx =>
        tx.from.toLowerCase().includes(query) || tx.to.toLowerCase().includes(query)
      )) return true;

      return false;
    });

    const totalBlocks = filtered.length;
    const totalPages = Math.ceil(totalBlocks / blocksPerPage);

    // Clamp currentPage if out of range
    if (currentPage > totalPages) currentPage = totalPages || 1;
    if (currentPage < 1) currentPage = 1;

    container.innerHTML = '';

    if (totalBlocks === 0) {
      container.innerHTML = '<p style="color: #f44336; font-weight: bold;">No results found.</p>';
      renderPagination(0);
      return;
    }

    // Pagination slice
    const startIdx = (currentPage - 1) * blocksPerPage;
    const endIdx = startIdx + blocksPerPage;
    const pagedBlocks = filtered.slice(startIdx, endIdx);

    pagedBlocks.forEach(block => {
      const div = document.createElement('div');
      div.className = 'block';

      div.innerHTML = `
        <p><strong>Index:</strong> ${block.index}</p>
        <p><strong>Timestamp:</strong> ${new Date(block.timestamp).toLocaleString()}</p>
        <p><strong>Hash:</strong> ${highlightMatch(block.hash, query)}</p>
        <p><strong>Previous Hash:</strong> ${highlightMatch(block.previousHash, query)}</p>
        <p><strong>Finalized:</strong> ${block.finalized ? '✅ Yes' : '⏳ No'}</p>
        <p><strong>Transactions:</strong></p>
        <ul>
          ${
            block.transactions.length === 0
              ? '<li>None</li>'
              : block.transactions.map(tx => {
                  const from = highlightMatch(tx.from, query);
                  const to = highlightMatch(tx.to, query);
                  return `<li>From: <strong>${from}</strong> → To: <strong>${to}</strong> — <strong>${tx.amount}</strong></li>`;
                }).join('')
          }
        </ul>
      `;
      container.appendChild(div);
    });

    renderPagination(totalBlocks);
  }

  // Initial fetch & render
  fetch('https://seagullcoin-dex-uaj3x.ondigitalocean.app/api/blocks')
    .then(res => res.json())
    .then(data => {
      allBlocks = data;
      renderBlocks();
    })
    .catch(err => {
      container.innerHTML = '❌ Failed to load blocks.';
      console.error(err);
    });

  // On search input, reset page and re-render
  searchInput.addEventListener('input', e => {
    currentPage = 1;
    renderBlocks(e.target.value.trim());
  });
</script>
  </body>
</html>
