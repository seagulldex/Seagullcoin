<script>
window.addEventListener('DOMContentLoaded', () => {
  const xumm = new XummPkceBrowser('ee60e1a3-8c08-4cdd-bfa9-accada591684', { implicit: true });

  const indicator = document.getElementById('wallet-indicator');
  const container = document.getElementById('wallet-container');
  const walletInfo = document.getElementById('wallet-info');
  const walletAddr = document.getElementById('wallet-address');

  xumm.on("ready", async () => {
    const state = await xumm.state();

    if (state?.me?.sub) {
      const account = state.me.sub;
      localStorage.setItem('xumm_wallet_address', account);
      walletAddr.innerText = account;
      walletInfo.style.display = 'block';
      indicator.textContent = 'ðŸŸ¢ Profile';
      indicator.classList.remove('red');
      indicator.classList.add('green');
      container.title = 'Go to profile';

      container.onclick = () => {
        alert(`Wallet connected: ${account}`);
      };

      unlockMinting();
    } else {
      walletInfo.style.display = 'none';
      indicator.textContent = 'ðŸ”´ Login';
      indicator.classList.remove('green');
      indicator.classList.add('red');
      container.title = 'Click to login';

      container.onclick = () => {
        xumm.authorize();
      };

      lockMinting();
    }
  });

  function unlockMinting() {
    console.log("Minting unlocked.");
  }

  function lockMinting() {
    console.log("Minting locked.");
  }
});
</script>
